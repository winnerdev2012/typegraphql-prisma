# Migration `20200908174507-many-to-many-test`

This migration has been generated by Micha≈Ç Lytek at 9/8/2020, 7:45:07 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Problem" (
"id" SERIAL,
"problemText" text   NOT NULL ,
"creatorId" integer   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Creator" (
"id" SERIAL,
"name" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_CreatorToProblem" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE UNIQUE INDEX "_CreatorToProblem_AB_unique" ON "public"."_CreatorToProblem"("A", "B")

CREATE INDEX "_CreatorToProblem_B_index" ON "public"."_CreatorToProblem"("B")

ALTER TABLE "public"."Problem" ADD FOREIGN KEY ("creatorId")REFERENCES "public"."Creator"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."_CreatorToProblem" ADD FOREIGN KEY ("A")REFERENCES "public"."Creator"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_CreatorToProblem" ADD FOREIGN KEY ("B")REFERENCES "public"."Problem"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER INDEX "public"."Category.slug_number" RENAME TO "Category.slug_number_unique"

ALTER INDEX "public"."User.email" RENAME TO "User.email_unique"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200701124231-initial..20200908174507-many-to-many-test
--- datamodel.dml
+++ datamodel.dml
@@ -1,96 +1,112 @@
-datasource db {
-  provider = "postgresql"
-  url = "***"
-}
-
-type Numeric = Float
-
-generator client {
-  provider      = "prisma-client-js"
-  binaryTargets = ["windows", "debian-openssl-1.1.x"]
-  output        = "../prisma/generated/client"
-}
-
-generator typegraphql {
-  provider = "node ../src/cli/dev.ts"
-  output   = "../prisma/generated/type-graphql"
-  emitDMMF = true
-}
-
-// Role enum comment
-/// Role enum doc
-enum Role {
-  USER
-  ADMIN
-}
-
-// User model comment
-/// User model doc
-/// @@TypeGraphQL.type("Client")
-model User {
-  // User model field comment
-  /// User model field doc
-  id      Int     @default(autoincrement()) @id
-  email   String  @unique
-  /// renamed field doc
-  /// @TypeGraphQL.field("firstName")
-  name    String?
-  age     Int
-  /// @TypeGraphQL.field("accountBalance")
-  balance Numeric
-  amount  Float
-  /// @TypeGraphQL.field("clientPosts")
-  posts   post[]
-  role    Role
-}
-
-enum PostKind {
-  BLOG
-  ADVERT
-}
-
-model post {
-  uuid      String    @default(uuid()) @id
-  createdAt DateTime  @default(now())
-  updatedAt DateTime  @updatedAt
-  published Boolean
-  title     String
-  content   String?
-  author    User      @relation(fields: [authorId], references: [id])
-  authorId  Int
-  kind      PostKind?
-  metadata  Json
-}
-
-model Category {
-  name   String
-  slug   String
-  number Int
-
-  @@unique([slug, number])
-}
-
-model Patient {
-  firstName String
-  lastName  String
-  email     String
-
-  @@id([firstName, lastName])
-}
-
-model Movie {
-  directorFirstName String
-  directorLastName  String
-  director          Director @relation(fields: [directorFirstName, directorLastName], references: [firstName, lastName])
-  title             String
-
-  @@id([directorFirstName, directorLastName, title])
-}
-
-model Director {
-  firstName String
-  lastName  String
-  movies    Movie[]
-
-  @@id([firstName, lastName])
-}
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+type Numeric = Float
+
+generator client {
+  provider        = "prisma-client-js"
+  binaryTargets   = ["windows", "debian-openssl-1.1.x"]
+  output          = "../prisma/generated/client"
+  previewFeatures = ["connectOrCreate", "atomicNumberOperations"]
+}
+
+generator typegraphql {
+  provider = "node ../src/cli/dev.ts"
+  output   = "../prisma/generated/type-graphql"
+  emitDMMF = true
+}
+
+// Role enum comment
+/// Role enum doc
+enum Role {
+  USER
+  ADMIN
+}
+
+// User model comment
+/// User model doc
+/// @@TypeGraphQL.type("Client")
+model User {
+  // User model field comment
+  /// User model field doc
+  id      Int     @default(autoincrement()) @id
+  email   String  @unique
+  /// renamed field doc
+  /// @TypeGraphQL.field("firstName")
+  name    String?
+  age     Int
+  /// @TypeGraphQL.field("accountBalance")
+  balance Numeric
+  amount  Float
+  /// @TypeGraphQL.field("clientPosts")
+  posts   post[]
+  role    Role
+}
+
+enum PostKind {
+  BLOG
+  ADVERT
+}
+
+model post {
+  uuid      String    @default(uuid()) @id
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+  published Boolean
+  title     String
+  content   String?
+  author    User      @relation(fields: [authorId], references: [id])
+  authorId  Int
+  kind      PostKind?
+  metadata  Json
+}
+
+model Category {
+  name   String
+  slug   String
+  number Int
+
+  @@unique([slug, number])
+}
+
+model Patient {
+  firstName String
+  lastName  String
+  email     String
+
+  @@id([firstName, lastName])
+}
+
+model Movie {
+  directorFirstName String
+  directorLastName  String
+  director          Director @relation(fields: [directorFirstName, directorLastName], references: [firstName, lastName])
+  title             String
+
+  @@id([directorFirstName, directorLastName, title])
+}
+
+model Director {
+  firstName String
+  lastName  String
+  movies    Movie[]
+
+  @@id([firstName, lastName])
+}
+
+model Problem {
+  id          Int       @default(autoincrement()) @id
+  problemText String
+  likedBy     Creator[]
+  creator     Creator?  @relation(name: "creator", fields: [creatorId], references: [id])
+  creatorId   Int?
+}
+
+model Creator {
+  id       Int       @default(autoincrement()) @id
+  name     String
+  likes    Problem[]
+  problems Problem[] @relation("creator")
+}
```


